import torch
import matplotlib.pyplot as plt

beta_start = 0.0001
beta_end = 0.02
T = 1000

# Use a cosine function to schedule beta for each iteration
t_values_cosine = torch.arange(1, T + 1, dtype=torch.float32)
beta_values_cosine = beta_start + 0.5 * (1.0 - torch.cos(t_values_cosine * 3.14159265359 / T)) * (beta_end - beta_start)

# Use linear spacing to schedule beta for each iteration
t_values_linear = torch.arange(1, T + 1, dtype=torch.float32)
beta_values_linear = torch.linspace(beta_start, beta_end, T, dtype=torch.float32)

# Plot both sets of beta values
plt.plot(t_values_cosine, beta_values_cosine, label='Cosine Annealing')
plt.plot(t_values_linear, beta_values_linear, label='Linear Spacing')
plt.xlabel('Iteration')
plt.ylabel('Beta Value')
plt.title('Comparison of Beta Schedules')
plt.legend()
plt.show()
